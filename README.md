# Framework to recreate the process to make shellcode

## Recreate the structure from The Anatomy of an Exploit

1. Target: __target.cpp__
~~~
clang++ -z execstack -fno-stack-protector -o target target.cpp
./target
~~~

2. C code for shellcode: __shellcode.c__

~~~
clang -Os -static -fno-stack-protector -o shellcode shellcode.c
./shellcode
~~~

3. Inline asm shellcode: __shellcode_asm.c__

~~~
clang -o shellcode_asm shellcode_asm.c
./shellcode_asm
~~~

4. Shellcode in char buffer test: __shellcode_test.c__

~~~
clang -z execstack -fno-stack-protector -o shellcode_test shellcode_test.c
./shellcode_test
~~~

5. Exploit framework: __exploit.c__

~~~
clang -o exploit exploit.c
./exploit
~~~

6. Pipe exploit output in as target input

~~~
./exploit | ./launch
~~~

## Reverse shell C code

In one terminal:

~~~
nc -nvlp 4444
~~~

In another:

~~~
clang -o reverse_shellcode reverse_shellcode.c
./reverse_shellcode
~~~

## Tips:

* strace

~~~
./exploit > file
strace -o strace.log ./launch < file
cat strace.log
~~~

* gdb

~~~
./exploit > file
gdb -q ./launch
(gdb) r < file
~~~

* objdump

~~~
objdump -d shellcode | grep -A 14 "<main>"
~~~
